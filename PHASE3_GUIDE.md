# ุฑุงูููุง ูุงุฒ 3 ู 4 - ุฌูููโูุง ุจุตุฑ ู ุตูุช

## ุฎูุงุตู ูพุงุฏูโุณุงุฒ

ูุงุฒ 3 ู 4 ุฌูููโูุง ุจุตุฑ ู ุตูุช ุฑุง ุจู ุจุงุฒ ุงุถุงูู ูโฺฉูุฏ ุชุง ุจุฑุง ฺฉูุฏฺฉุงู ุฌุฐุงุจโุชุฑ ู ุขููุฒุดโุชุฑ ุดูุฏ.

---

## ูฺฺฏโูุง ุฌุฏุฏ

### 1. ุณุณุชู Texture (ุชุตุงูุฑ)

**ูุฏู:** ุงุณุชูุงุฏู ุงุฒ ุชุตุงูุฑ PNG ุจู ุฌุง ูุชู ุณุงุฏู ุจุฑุง ููุงุด ุงุนุฏุงุฏ

**ูพุงุฏูโุณุงุฒ:**
- ุฎูุงูุฏู ุชุตุงูุฑ ุงุฒ ูพูุดู `assets/textures/`
- ูุฑูุช ูุงูโฺฏุฐุงุฑ: `{number}.png` (ูุซูุงู `1.png`, `2.png`)
- ุงฺฏุฑ ุชุตูุฑ ููุฌูุฏ ูุจุงุดุฏุ ุงุฒ ูุชู ุงุณุชูุงุฏู ูโุดูุฏ

**ฺฉุฏ:**
```python
def _load_texture(self, number):
    texture_path = Path(f'assets/textures/{number}.png')
    if texture_path.exists():
        return load_texture(str(texture_path))
    return None

# ุฏุฑ __init__
self.number_texture = self._load_texture(number)
if self.number_texture:
    self.number_image = Entity(
        model='quad',
        texture=self.number_texture,
        parent=self,
        scale=(1.2, 1.2)
    )
```

**ูุฒุงุง:**
- ุชุตุงูุฑ ุฑูฺฏ ู ุฌุฐุงุจ ุจุฑุง ฺฉูุฏฺฉุงู
- ุงูฺฉุงู ุงุณุชูุงุฏู ุงุฒ ุทุฑุญโูุง ุณูุงุฑุด
- ุฎูุงูุง ุจูุชุฑ
- Fallback ุฎูุฏฺฉุงุฑ ุจู ูุชู

---

### 2. ุงููุดูโูุง ูุฑูโุชุฑ

**ูุฏู:** ุงูุฒูุฏู ุฌูููโูุง ุจุตุฑ ุฌุฐุงุจ ููฺฏุงู ูพุฏุง ฺฉุฑุฏู ุฌูุช

**ุงููุดู ูุจู:**
```python
# ููุท ุณุจุฒ ุดุฏู ู ฺฉูฺฺฉ ุดุฏู
self.color = color.green
self.animate_scale(0, duration=0.3)
```

**ุงููุดู ุฌุฏุฏ (ุณู ูุฑุญููโุง):**
```python
# ูุฑุญูู 1: ูพุฑุด (Bounce) ุจุง curve.out_back
self.animate_scale(
    original_scale * 1.3,
    duration=0.15,
    curve=curve.out_back
)

# ูุฑุญูู 2: ุจุฑฺฏุดุช ุจู ุงูุฏุงุฒู ูุฑูุงู
invoke(lambda: self.animate_scale(
    original_scale,
    duration=0.15
), delay=0.15)

# ูุฑุญูู 3: ฺฉูฺฺฉ ุดุฏู ู ูุญู
invoke(lambda: self.animate_scale(
    0,
    duration=0.4
), delay=0.4)
```

**ูฺฺฏโูุง:**
- ุงุณุชูุงุฏู ุงุฒ `curve.out_back` ุจุฑุง ุงูฺฉุช ูพุฑุด
- ุณู ูุฑุญูู: ูพุฑุด โ ุจุฑฺฏุดุช โ ูุญู
- ฺฉู ูุฏุช: 0.8 ุซุงูู (ุจุดุชุฑ ุงุฒ 0.3 ุซุงูู ูุจู)
- ุฌุฐุงุจโุชุฑ ู ุชุฃุซุฑฺฏุฐุงุฑุชุฑ

---

### 3. ุตุฏุงฺฏุฐุงุฑ (Audio System)

**ูุฏู:** ุงูุฒูุฏู ุฌูููโูุง ุตูุช ุจุฑุง ุชุนุงูู ุจูุชุฑ

#### ฺฉูุงุณ AudioManager

```python
class AudioManager:
    def __init__(self):
        self.sounds = {}
        self.load_sounds()
    
    def load_sounds(self):
        sound_files = {
            'click': 'click.wav',
            'success': 'success.mp3',
            'wrong': 'wrong.wav'
        }
        for sound_name, filename in sound_files.items():
            sound_file = Path('assets/sounds') / filename
            if sound_file.exists():
                self.sounds[sound_name] = Audio(str(sound_file))
    
    def play(self, sound_name):
        if sound_name in self.sounds:
            self.sounds[sound_name].play()
```

#### ุตุฏุงูุง ุจุงุฒ

**1. ฺฉูฺฉ (click.wav):**
- ุฒูุงู ูพุฎุด: ููฺฏุงู ฺฉูฺฉ ุฑู ฺฉุงุฑุช
- ูฺฉุงู: `NumberCard.input()`
- ูฺฺฏ: ฺฉูุชุงู ู ููุงู (< 0.5 ุซุงูู)

```python
if game_manager.audio_manager:
    game_manager.audio_manager.play('click')
```

**2. ููููุช (success.mp3):**
- ุฒูุงู ูพุฎุด: ููฺฏุงู ูพุฏุง ฺฉุฑุฏู ุฌูุช ุฏุฑุณุช
- ูฺฉุงู: `on_match_success()`
- ูฺฺฏ: ุดุงุฏ ู ุงูฺฏุฒูโุจุฎุด (1-2 ุซุงูู)

```python
if self.audio_manager:
    self.audio_manager.play('success')
```

**3. ุงุดุชุจุงู (wrong.wav):**
- ุฒูุงู ูพุฎุด: ููฺฏุงู ุงูุชุฎุงุจ ุฌูุช ูุงุฏุฑุณุช
- ูฺฉุงู: `on_match_failure()`
- ูฺฺฏ: ููุงู ู ุบุฑ ููู (< 1 ุซุงูู)

```python
if self.audio_manager:
    self.audio_manager.play('wrong')
```

---

### 4. ุณุณุชู ุฐุฑุงุช (Particle System)

**ูุฏู:** ุงุฌุงุฏ ุฌุดู ุจุตุฑ ุจุง ุฐุฑุงุช ุฑูฺฏ (confetti) ููฺฏุงู ููููุช

#### ฺฉูุงุณ ConfettiParticle

```python
class ConfettiParticle(Entity):
    def __init__(self, position):
        # ุฑูฺฏ ุชุตุงุฏู ุงุฒ ูุณุช ุฑูฺฏโูุง
        colors = [color.yellow, color.orange, color.pink, 
                  color.cyan, color.lime, color.magenta]
        particle_color = random.choice(colors)
        
        super().__init__(
            model='quad',
            color=particle_color,
            position=position,
            scale=0.15
        )
        
        # ุณุฑุนุช ุงููู ุชุตุงุฏู (ูพุฑุด ุจู ุจุงูุง)
        self.velocity = Vec3(
            random.uniform(-3, 3),    # ุฌูุช ุงูู
            random.uniform(3, 6),     # ูพุฑุด ุจู ุจุงูุง
            random.uniform(-1, 1)     # ุนูู
        )
        
        # ฺฏุฑุงูุด
        self.gravity = -15
        
        # ุฒูุงู ุฒูุฏฺฏ
        self.lifetime = 1.5
        self.age = 0
    
    def update(self):
        dt = time.dt
        self.age += dt
        
        # ุญุฐู ุจุนุฏ ุงุฒ ุงุชูุงู ุฒูุงู
        if self.age >= self.lifetime:
            destroy(self)
            return
        
        # ุงุนูุงู ฺฏุฑุงูุด
        self.velocity.y += self.gravity * dt
        
        # ุจูโุฑูุฒุฑุณุงู ูููุนุช
        self.position += self.velocity * dt
        
        # ฺุฑุฎุด
        self.rotation_z += 360 * dt
        
        # ูุญู ุดุฏู ุชุฏุฑุฌ
        alpha = int(255 * (1 - self.age / self.lifetime))
        self.color = color.rgba(
            self.color.r * 255,
            self.color.g * 255,
            self.color.b * 255,
            alpha
        )
```

#### ุงุฌุงุฏ ุฐุฑุงุช

```python
def spawn_confetti(self, position):
    # ุงุฌุงุฏ 8-12 ุฐุฑู
    num_particles = random.randint(8, 12)
    for _ in range(num_particles):
        ConfettiParticle(position=position)

# ุฏุฑ on_match_success
self.spawn_confetti(card1.position)
self.spawn_confetti(card2.position)
```

**ูฺฺฏโูุง ุฐุฑุงุช:**
- ุฑูฺฏโูุง ูุชููุน: ุฒุฑุฏุ ูุงุฑูุฌุ ุตูุฑุชุ ุขุจุ ุณุจุฒ ูููุ ุจููุด
- ุญุฑฺฉุช ูุฒฺฉ ุจุง ฺฏุฑุงูุด
- ฺุฑุฎุด ุฏุฑ ุญู ุณููุท
- ูุญู ุดุฏู ุชุฏุฑุฌ
- ุฎูุฏฺฉุงุฑ ุญุฐู ูโุดููุฏ

---

### 5. ุจูุจูุฏ ุฎูุงูุง ุงุนุฏุงุฏ

**ูุฏู:** ุชูุฑฺฉุฒ ุจุฑ ุฎูุงูุง ุงุนุฏุงุฏ ุจุฑุง ุฏุงูุดโุขููุฒุงู

**ุจูุจูุฏูุง ุงุนูุงู ุดุฏู:**

**1. ุงูุฒุงุด ุงูุฏุงุฒู:**
```python
# ูุจู: scale=3
# ุจุนุฏ: scale=4
self.number_text = Text(
    text=str(number),
    scale=4,  # 33% ุจุฒุฑฺฏโุชุฑ
    ...
)
```

**2. ุฑูฺฏ ูุงุถุญโุชุฑ:**
```python
# ูุชู ุณุงู ุฑู ูพุณโุฒููู ุณูุฏ
color=color.black  # ฺฉูุชุฑุงุณุช ุจูุชุฑ
```

**3. ูพุณโุฒููู ุฑูุดู:**
```python
# ฺฉุงุฑุช ุณูุฏ ููุช ุจุงุฒ ุงุณุช
self.color = color.white
```

**4. ุนูุงูุช ุณูุงู ุจุฒุฑฺฏโุชุฑ:**
```python
self.back_text = Text(
    text='?',
    scale=4,  # ุงูุฒุงุด ุงุฒ 3 ุจู 4
    ...
)
```

---

## ุณุงุฎุชุงุฑ ุฏุงุฑุงโูุง (Assets)

### ูพูุดู assets/textures/

```
assets/textures/
โโโ 1.png    # ุชุตูุฑ ุนุฏุฏ 1
โโโ 2.png    # ุชุตูุฑ ุนุฏุฏ 2
โโโ 3.png    # ุชุตูุฑ ุนุฏุฏ 3
...
โโโ 20.png   # ุชุตูุฑ ุนุฏุฏ 20
```

**ุฑุงูููุง ุงุฌุงุฏ ุชุตุงูุฑ:**
- ุงูุฏุงุฒู: 256ร256 ูพฺฉุณู (ุชูุตู ุดุฏู)
- ูุฑูุช: PNG ุจุง ูพุณโุฒููู ุดูุงู
- ุงุณุชุงู: ุนุฏุฏูุง ูุงุถุญุ ุฑูฺฏุ ฺฉูุฏฺฉโูพุณูุฏ
- ูููุช: ุจุฒุฑฺฏ ู ุฎูุงูุง

### ูพูุดู assets/sounds/

```
assets/sounds/
โโโ click.wav      # ุตุฏุง ฺฉูฺฉ
โโโ success.mp3    # ุตุฏุง ููููุช
โโโ wrong.wav      # ุตุฏุง ุงุดุชุจุงู
```

**ุฑุงูููุง ุตุฏุงูุง:**
- click.wav: ฺฉูุชุงู ู ููุงู (< 0.5s)
- success.mp3: ุดุงุฏ ู ุงูฺฏุฒูโุจุฎุด (1-2s)
- wrong.wav: ููุงู ู ุบุฑ ููู (< 1s)

---

## ูุซุงู ุงุณุชูุงุฏู

### ุจุงุฒ ุจุง ุชุตุงูุฑ:
```python
# 1. ุชุตุงูุฑ ุฑุง ุฏุฑ assets/textures/ ูุฑุงุฑ ุฏูุฏ
# 2. ุจุงุฒ ุฑุง ุงุฌุฑุง ฺฉูุฏ
python main.py

# ุจุงุฒ ุฎูุฏฺฉุงุฑ ุชุตุงูุฑ ุฑุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ
# ุงฺฏุฑ ุชุตูุฑ ูุจุงุดุฏุ ุงุฒ ูุชู ุงุณุชูุงุฏู ูโฺฉูุฏ
```

### ุจุงุฒ ุจุง ุตุฏุงูุง:
```python
# 1. ุตุฏุงูุง ุฑุง ุฏุฑ assets/sounds/ ูุฑุงุฑ ุฏูุฏ
# 2. ุจุงุฒ ุฑุง ุงุฌุฑุง ฺฉูุฏ

# ุตุฏุงูุง ุฎูุฏฺฉุงุฑ ูพุฎุด ูโุดููุฏ:
# - ฺฉูฺฉ ุฑู ฺฉุงุฑุช โ click.wav
# - ุฌูุช ุฏุฑุณุช โ success.mp3
# - ุฌูุช ูุงุฏุฑุณุช โ wrong.wav
```

---

## ุฌุฑุงู ฺฉุงูู ุจุงุฒ

### ุณูุงุฑู: ูพุฏุง ฺฉุฑุฏู ุฌูุช ูููู

```
1. ฺฉูุฏฺฉ ุฑู ฺฉุงุฑุช ุงูู ฺฉูฺฉ ูโฺฉูุฏ
   โโ ๐ ุตุฏุง click.wav ูพุฎุด ูโุดูุฏ
   โโ ๐ด ฺฉุงุฑุช ุจุง ุงููุดู ฺุฑุฎุด ุจุงุฒ ูโุดูุฏ
   โโ ๐ข ุนุฏุฏ (ุชุตูุฑ ุง ูุชู) ููุงุด ุฏุงุฏู ูโุดูุฏ

2. ฺฉูุฏฺฉ ุฑู ฺฉุงุฑุช ุฏูู ฺฉูฺฉ ูโฺฉูุฏ
   โโ ๐ ุตุฏุง click.wav ูพุฎุด ูโุดูุฏ
   โโ ๐ด ฺฉุงุฑุช ุจุงุฒ ูโุดูุฏ

3. ุณุณุชู ุชุทุจู ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ [0.5s]
   โโ โ ุงุนุฏุงุฏ ฺฉุณุงู ูุณุชูุฏ!

4. ุฌุดู ููููุช:
   โโ ๐ ุตุฏุง success.mp3 ูพุฎุด ูโุดูุฏ
   โโ ๐ 16-24 ุฐุฑู confetti ูพุฎุด ูโุดูุฏ
   โโ ๐จ ฺฉุงุฑุชโูุง ุณุจุฒ ูโุดููุฏ
   โโ ๐ ุงููุดู ูพุฑุด (bounce ุจุง curve.out_back)
   โโ โฌ๏ธ ุจุฒุฑฺฏ ุดุฏู ุจู 1.3x [0.15s]
   โโ โฌ๏ธ ุจุฑฺฏุดุช ุจู ุงูุฏุงุฒู ูุฑูุงู [0.15s]
   โโ ๐ซ ฺฉูฺฺฉ ุดุฏู ู ูุญู [0.4s]
   โโ โญ ุงูุชุงุฒ ุจุงุฒฺฉู +1

5. ุฐุฑุงุช confetti:
   โโ ๐ ุฑูฺฏโูุง ูุชููุน
   โโ โฌ๏ธ ูพุฑุด ุจู ุจุงูุง
   โโ ๐ ฺุฑุฎุด
   โโ โฌ๏ธ ุณููุท ุจุง ฺฏุฑุงูุด
   โโ ๐ป ูุญู ุดุฏู [1.5s]
```

---

## ูฺฉุงุช ูู

### 1. Graceful Degradation

ุจุงุฒ ุจุฏูู ุฏุงุฑุงโูุง ุฎุงุฑุฌ ฺฉุงุฑ ูโฺฉูุฏ:

```python
# ุจุฏูู ุชุตุงูุฑ
if not self.number_texture:
    # ุงุณุชูุงุฏู ุงุฒ ูุชู
    self.number_text = Text(...)

# ุจุฏูู ุตุฏุงูุง
if self.audio_manager:
    self.audio_manager.play('click')
# ุงฺฏุฑ audio_manager ูุจุงุดุฏุ ุจโุตุฏุง ุงุฏุงูู ูโุฏูุฏ
```

### 2. ูุฏุฑุช ุฎุทุง

```python
try:
    self.sounds[sound_name] = Audio(str(sound_file))
except:
    print(f"โ๏ธ ููโุชูุงู ุตุฏุง {filename} ุฑุง ุจุงุฑฺฏุฐุงุฑ ฺฉุฑุฏ")
# ุจุงุฒ ุงุฏุงูู ูโุงุจุฏ
```

### 3. ุจูููโุณุงุฒ ุญุงูุธู

```python
# ุฐุฑุงุช ุฎูุฏฺฉุงุฑ ุญุฐู ูโุดููุฏ
if self.age >= self.lifetime:
    destroy(self)
```

---

## ุขูุงุฑ ูพุงุฏูโุณุงุฒ

- **ุฎุทูุท ฺฉุฏ ุฌุฏุฏ:** ~200
- **ฺฉู ุฎุทูุท:** ~500
- **ฺฉูุงุณโูุง ุฌุฏุฏ:** 2 (AudioManager, ConfettiParticle)
- **ูุชุฏูุง ุฌุฏุฏ:** 5
- **ูฺฺฏโูุง ุจุตุฑ:** 3 (texture, animation, particles)
- **ูฺฺฏโูุง ุตูุช:** 3 (click, success, wrong)

---

## ุชุณุช

ุจุฑุง ุชุณุช ูุงุฒ 3 ู 4:
```bash
python test_phase3.py
```

ุงู ุงุณฺฉุฑูพุช ุชูุงู ูฺฺฏโูุง ูุงุฒ 3 ู 4 ุฑุง ุจุฏูู ูุงุฒ ุจู ุงุฌุฑุง GUI ุจุฑุฑุณ ูโฺฉูุฏ.

---

## ูุงุฒ ุจุนุฏ (ูุงุฒ 5)

ุฏุฑ ูุงุฒูุง ุจุนุฏ ูโุชูุงู:
- ููู ุงุตู ุจุฑุง ุงูุชุฎุงุจ ุณุทุญ ุณุฎุช
- ุตูุญู ูพุงุงู ุจุงุฒ ุจุง ุขูุงุฑ
- ููุณู ูพุณโุฒููู
- ุงููุดูโูุง ูพุดุฑูุชูโุชุฑ
- ุณุณุชู ุฑฺฉูุฑุฏ ู ุงูุชุงุฒุฏู

---

## ูุชุฌูโฺฏุฑ

ูุงุฒ 3 ู 4 ุจุงุฒ ุฑุง ุงุฒ ูุธุฑ ุจุตุฑ ู ุตูุช ุชุจุฏู ุจู ฺฉ ุชุฌุฑุจู ุฌุฐุงุจ ุจุฑุง ฺฉูุฏฺฉุงู ฺฉุฑุฏู ุงุณุช:

โ ุชุตุงูุฑ ุฑูฺฏ ุจู ุฌุง ูุชู ุณุงุฏู  
โ ุงููุดูโูุง ูพูุง ู ุฌุฐุงุจ  
โ ุตุฏุงูุง ุชุนุงูู  
โ ุฌูููโูุง ุฐุฑูโุง (confetti)  
โ ุฎูุงูุง ุจูุชุฑ ุจุฑุง ุงุฏฺฏุฑ  

**ุจุงุฒ ุญุงูุง ุขูุงุฏู ุงุณุช ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ฺฉูุงุณ ุฏุฑุณ ุจุง ุชุฌุฑุจูโุง ฺฉุงูู!** ๐จ๐๐
